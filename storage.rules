rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {
    // Profile images: path is profiles/{userId}.{ext}. Users can write only when the file name starts with their uid.
    match /profiles/{fileName} {
      allow read: if true;
      allow write: if request.auth != null
        && (fileName == request.auth.uid + '.jpg'
            || fileName == request.auth.uid + '.jpeg'
            || fileName == request.auth.uid + '.png'
            || fileName == request.auth.uid + '.gif'
            || fileName == request.auth.uid + '.webp');
    }
  }
}
